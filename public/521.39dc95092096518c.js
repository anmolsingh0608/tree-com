"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[521],{521:(q,d,n)=>{n.r(d),n.d(d,{UsersModule:()=>y});var p=n(6895),l=n(2977),c=n(9625),i=n(4719),e=n(6353),U=n(2340),f=n(529);let h=(()=>{class r{constructor(t){this.http=t,this.apiUrl=U.N.apiUrl}getUsers(){return this.http.get(`${this.apiUrl}/users`)}getUser(t){return this.http.get(`${this.apiUrl}/users/${t}`)}createUser(t){return this.http.post(`${this.apiUrl}/users`,t)}deleteUser(t){return this.http.delete(`${this.apiUrl}/users/${t}`)}updateUser(t,s){return this.http.put(`${this.apiUrl}/users/${s}`,t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(f.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var v=n(4465);let m=(()=>{class r{constructor(t,s,a,u){this.userService=t,this.router=s,this.route=a,this.toastService=u,this.subscriptions=[],this.userForm=new i.cw({username:new i.NI("",i.kI.required),password:new i.NI("",i.kI.required),email:new i.NI("",[i.kI.required,i.kI.email]),role:new i.NI("",i.kI.required)}),this.userData={}}ngOnInit(){const t=this.route.params.subscribe(s=>{if(s.id){this.userId=s.id;const a=this.userService.getUser(s.id).subscribe(u=>{this.userData=u.data,this.userForm.patchValue(this.userData),this.userForm.get("password").clearValidators(),this.userForm.get("password").updateValueAndValidity()});this.subscriptions.push(a)}});this.subscriptions.push(t)}save(){if(this.userForm.invalid)return void this.toastService.presentToast("Please fill all the required fields");let t;t=this.userId?this.userService.updateUser(this.userForm.value,this.userId):this.userService.createUser(this.userForm.value);const s=t.subscribe(a=>{this.toastService.presentToast("User saved successfully"),this.navigateToList()});this.subscriptions.push(s)}navigateToList(){this.router.navigate(["/admin/users/"])}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(h),e.Y36(c.F0),e.Y36(c.gz),e.Y36(v.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create"]],decls:30,vars:1,consts:[[1,"container"],[1,"header","d-flex","justify-content-between"],[3,"formGroup"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username","placeholder","Enter Username",1,"form-control"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Enter Password",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Email",1,"form-control"],["for","role"],["id","role","formControlName","role",1,"form-select"],["value",""],["value","ADMIN"],["value","FORESTER"],[1,"btn","btn-primary","mt-2",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"h2"),e._uU(4,"Users"),e.qZA()(),e.TgZ(5,"form",2)(6,"div",3)(7,"label",4),e._uU(8,"Username"),e.qZA(),e._UZ(9,"input",5),e.qZA(),e.TgZ(10,"div",3)(11,"label",6),e._uU(12,"Password"),e.qZA(),e._UZ(13,"input",7),e.qZA(),e.TgZ(14,"div",3)(15,"label",8),e._uU(16,"Email"),e.qZA(),e._UZ(17,"input",9),e.qZA(),e.TgZ(18,"div",3)(19,"label",10),e._uU(20,"Role"),e.qZA(),e.TgZ(21,"select",11)(22,"option",12),e._uU(23,"None"),e.qZA(),e.TgZ(24,"option",13),e._uU(25,"Admin"),e.qZA(),e.TgZ(26,"option",14),e._uU(27,"Forester"),e.qZA()()(),e.TgZ(28,"button",15),e.NdJ("click",function(){return s.save()}),e._uU(29,"Save"),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("formGroup",s.userForm))},dependencies:[l.W2,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,i.sg,i.u]}),r})();var Z=n(5861);function b(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",6)(8,"button",7)(9,"span",8),e._uU(10," edit "),e.qZA()(),e.TgZ(11,"button",9),e.NdJ("click",function(){const u=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.deleteUser(u.id))}),e.TgZ(12,"span",8),e._uU(13," delete "),e.qZA()()()()}if(2&r){const t=o.$implicit,s=o.index;e.xp6(2),e.Oqu(s+1),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.role),e.xp6(2),e.MGl("routerLink","/admin/users/create/",t.id,"")}}const T=[{path:"",component:(()=>{class r{constructor(t,s){this.userService=t,this.alertController=s,this.subscriptions=[],this.users=[]}ngOnInit(){}ionViewDidEnter(){const t=this.getUsers().subscribe(s=>{this.users=s.data});this.subscriptions.push(t)}getUsers(){return this.userService.getUsers()}deleteUser(t){var s=this;return(0,Z.Z)(function*(){yield(yield s.alertController.create({header:"Do you want to delete this user?",buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Delete",role:"confirm",handler:()=>{const u=s.userService.deleteUser(t).subscribe(g=>{s.users=s.users.filter(F=>F.id!==t)});s.subscriptions.push(u)}}]})).present()})()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(h),e.Y36(l.Br))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-list"]],decls:20,vars:1,consts:[[1,"container"],[1,"header","d-flex","justify-content-between"],["routerLink","/admin/users/create",1,"btn","btn-primary"],[1,"table-responsive"],[1,"table-striped","w-100"],[4,"ngFor","ngForOf"],[1,"p-1"],[1,"btn","btn-primary",3,"routerLink"],[1,"material-icons-outlined"],[1,"btn","btn-danger","ms-1",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"h2"),e._uU(4,"Users"),e.qZA(),e.TgZ(5,"button",2),e._uU(6,"Add User"),e.qZA()(),e.TgZ(7,"div",3)(8,"table",4)(9,"thead")(10,"th"),e._uU(11,"#"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Username"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Role"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Actions"),e.qZA()(),e.TgZ(18,"tbody"),e.YNc(19,b,14,4,"tr",5),e.qZA()()()()()),2&t&&(e.xp6(19),e.Q6J("ngForOf",s.users))},dependencies:[p.sg,l.W2,l.YI,c.rH]}),r})()},{path:"create",component:m},{path:"create/:id",component:m}];let A=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(T),c.Bz]}),r})(),y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.ez,l.Pc,A,i.UX]}),r})()}}]);